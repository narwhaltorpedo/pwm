/*
 * Password utilities.
 *
 */

#ifndef PWM_PASSWORD_INCLUDE_GUARD
#define PWM_PASSWORD_INCLUDE_GUARD


/*--------------------------------------------------------------------------------------------------
*
* Password lengths.
*
*-------------------------------------------------------------------------------------------------*/
#define MAX_PASSWORD_LEN                100
#define MIN_PASSWORD_LEN                4


/*--------------------------------------------------------------------------------------------------
*
* Maximum password size.
*
*-------------------------------------------------------------------------------------------------*/
#define MAX_PASSWORD_SIZE               (MAX_PASSWORD_LEN + 1)


/*--------------------------------------------------------------------------------------------------
*
* Serialized configuration data size.
*
*-------------------------------------------------------------------------------------------------*/
#define CONFIG_DATA_SIZE                4


/*--------------------------------------------------------------------------------------------------
*
* Load password generation configuration.
*
*-------------------------------------------------------------------------------------------------*/
void LoadPwdGenCfg
(
    const uint8_t *serialCfgDataPtr     ///< [IN] Serialized configuration data.  Assumed to be
                                        ///       CONFIG_DATA_SIZE.
);


/*--------------------------------------------------------------------------------------------------
*
* Get serialized password generation configuration data.
*
*-------------------------------------------------------------------------------------------------*/
void GetSerializedPwdGenCfgData
(
    uint8_t *bufPtr                     ///< [OUT] Buffer to store serialized configuration data.
                                        ///        Assumed to be CONFIG_DATA_SIZE.
);


/*--------------------------------------------------------------------------------------------------
*
* Show current password generation configuration data.
*
*-------------------------------------------------------------------------------------------------*/
void ShowPwdGenConfig
(
    void
);


/*--------------------------------------------------------------------------------------------------
*
* Set use nums in password generation.
*
*-------------------------------------------------------------------------------------------------*/
void PwdGenUseNums
(
    bool useNums
);


/*--------------------------------------------------------------------------------------------------
*
* Set use letters in password generation.
*
*-------------------------------------------------------------------------------------------------*/
void PwdGenUseLetters
(
    bool useLetters
);


/*--------------------------------------------------------------------------------------------------
*
* Set use special characters in password generation.
*
*-------------------------------------------------------------------------------------------------*/
void PwdGenUseSpecialChars
(
    bool useSpecialChars
);


/*--------------------------------------------------------------------------------------------------
*
* Set generated password length.
*
*-------------------------------------------------------------------------------------------------*/
void PwdGenLen
(
    uint8_t len
);


/*--------------------------------------------------------------------------------------------------
*
* Generate a password.
*
*-------------------------------------------------------------------------------------------------*/
void GeneratePassword
(
    char* bufPtr,                       ///< [OUT] Buffer to hold password.
    size_t bufSize                      ///< [IN] Buffer size.
);


/*--------------------------------------------------------------------------------------------------
*
* Check if the password is meets requirements.
*
* @return
*       true if successful.
*       false otherwise.
*
*-------------------------------------------------------------------------------------------------*/
bool IsPasswordValid
(
    const char *pwdPtr                  ///< [IN] Password to check.
);


#endif // PWM_PASSWORD_INCLUDE_GUARD
